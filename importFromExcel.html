<h1> Импорт из Excel / Экспорт в Excel </h1>
<hr/>

<li> функционал импорта из 'Единых шаблонов Excel' </li>

<h2> Импорт договоров </h2>

<h3> Алгоритм поиска/создания договора </h3>
<pre>
    <i>//примечание: ОРГ/ФЛ - это ОРГ если в шаблоне указан только ОРГ, это ФЛ если в шаблоне указан только ФЛ,
        это ФЛ если в шаблоне указан и ФЛ и ОРГ</i>

    если (в шаблоне указан ОРГ/ФЛ) {
        010: если (ОРГ/ФЛ найден в системе) {
            ищем договор по "Вид документа+Дата договора+Номер договора+ОРГ/ФЛ"
        } иначе {
            ищем договор по "Вид документа+Дата договора+Номер договора+X"
            (где Х это ФЛ=null если ОРГ указан в шаблоне и не найден в системе,
                 и Х это ОРГ=null если ФЛ указан в шаблоне и не найден в системе)
        }
        020: если на шаге 010 договор найден не был, создаём его
    } иначе {
         ищем существующий договор по "Вид документа+Дата договора+Номер договора",
            если не находим создаём новый
    }

</pre>

<hr>
<a href="index.html">Главная</a>
